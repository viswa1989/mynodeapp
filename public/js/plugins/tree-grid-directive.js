(function(){angular.module("template/treeGrid/treeGrid.html",[]).run(["$templateCache",function(e){e.put("template/treeGrid/treeGrid.html",'<div class=" table-responsive">\n<div class="tree_table"> <table class="table tree-grid" >\n   <thead>\n     <tr class=\'tree_tr_title\'>\n       <th><a class=\'tree_title\' ng-if="expandingProperty.sortable" ng-click="sortBy(expandingProperty)">{{expandingProperty.displayName || expandingProperty.field || expandingProperty}}</a><span ng-if="!expandingProperty.sortable">{{expandingProperty.displayName || expandingProperty.field || expandingProperty}}</span></th>\n       <th ng-repeat="col in colDefinitions"><a  class=\'tree_title\' ng-if="col.sortable" ng-click="sortBy(col)">{{col.displayName || col.field}}</a><span ng-if="!col.sortable">{{col.displayName || col.field}}</span></th>\n     </tr>\n   </thead>\n   <tbody>\n     <tr ng-repeat="row in tree_rows | searchFor:$parent.filterString:expandingProperty:colDefinitions track by row.branch.uid"\n     t1="{{checkIamvisiblenode(row.branch)}}" t2="{{row.branch.uid}}" t3="{{row.branch.parent_uid}}" ng-class="\'level-\' + {{ row.level }} + (row.branch.selected ? \' active\':\'\')" class="tree-grid-row" ng-if="checkIamvisiblenode(row.branch)" ng-init="parentIndex=$index;row.branch.parentnodedisable=row.branch.nodeDisabled;row.branch.group=getOneCopyOfGroupList()">\n       <td  class="acc_td_left"  t1="{{row.branch.parentnodedisable}}"><span class=\'tree_expand_icon\' ng-click="user_clicks_branch(row.branch)"><i ng-class="row.tree_icon"\n              ng-click="row.branch.expanded = !row.branch.expanded"\n              class="indented tree-icon"></i>\n           </span><span ng-if="row.branch.first"  class="indented tree-label"><input class=\'tree_input\' type="text" ng-model="row.branch.category_name" ng-blur="row.branch.first=false" ng-focus="row.branch.first" /></span>\t\t\t <span class="indented tree-label" ng-dblclick="on_user_click(row.branch);row.branch.first=true;" ng-if="!row.branch.first">\n             {{row.branch.category_name}}</span>\n       </td>\n       <td ng-repeat="col in colDefinitions" class="acc_td_right">\n         <span class=\'tree_right_text\' ng-if="col.cellTemplate" compile="col.cellTemplate" cell-template-scope="col.cellTemplateScope"></span>\n         <span class=\'tree_right_text\'  ng-if="!col.cellTemplate && !row.branch.second" ng-dblclick="on_user_click(row.branch);row.branch.second=true;"  >{{row.branch.groupname}}</span>\n         <span class=\'tree_right_text\' ng-if="row.branch.second" ><select ng-model="row.branch.groupunique" ng-blur="row.branch.second=false" ng-change="changeCurrentBranchGroupValue(row.branch,row.branch.groupunique)"><option ng-repeat="group in row.branch.group" ng-selected="row.branch.groupunique==group.groupunique" value="{{group.groupunique}}">{{group.groupname}}</option></select></span>\n         <span class=\'tree_sub_add_icon tree_icon_toggle\' ng-if="row.level!=3" ng-click="addNewNodeOnTree(row.branch)"></span><span class=\'tree_sub_remove_icon tree_icon_toggle\'  ng-if="row.branch.remove !=\'false\' && row.branch.DEFAULT !=\'true\'" noty-remove  noty-scope="row.branch" noty-index="{{$index}}" noty-update="removeCurrentBrand" noty-style="1" noty-content="Are you sure?" ></span>\n       </td>\n   </tbody>\n </table> </div>\n'+" <div class='clearboth'></div> <table class=\"tree_table\" style='margin-top:-20px !important; width:780px !important;'> <tr style='border-bottom:1px solid rgb(204,204,204) !important'; ><td style='padding:10px !important;'><span class='tree_sub_add_icon' style='padding:3px 10px;' ng-click='createNewParentTreeNode()'></span></td></tr> </table>\n</div>\n")}]),angular.module("treeGrid",["template/treeGrid/treeGrid.html"]).directive("compile",["$compile",function(e){return{restrict:"A",link:function(n,r,t){n.cellTemplateScope=n.$eval(t.cellTemplateScope),n.$watch(t.compile,function(t){var a=e(t)(n);r.append(a)})}}}]).directive("treeGrid",["$timeout","treegridTemplate",function(e,n){return{restrict:"E",templateUrl:function(e,r){return r.templateUrl||n.getPath()},replace:!0,scope:{treeData:"=",colDefs:"=",expandOn:"=",onSelect:"&",onClick:"&",initialSelection:"@",treeControl:"=",disableNode:"="},link:function(n,r,t){var a,i,l,c,o,u,d,s,p,f,h;if(function(e){},t.iconExpand=t.iconExpand?t.iconExpand:"icon-plus icon_expand   ",t.iconCollapse=t.iconCollapse?t.iconCollapse:"icon-minus icon_expand_close  ",t.iconLeaf=t.iconLeaf?t.iconLeaf:"icon-file  glyphicon glyphicon-file  fa fa-file",t.sortedAsc=t.sortedAsc?t.sortedAsc:"icon-file  glyphicon glyphicon-chevron-up  fa angle-up",t.sortedDesc=t.sortedDesc?t.sortedDesc:"icon-file  glyphicon glyphicon-chevron-down  fa angle-down",t.expandLevel=t.expandLevel?t.expandLevel:"3",l=parseInt(t.expandLevel,10),n.treeData){var g=function(){if(t.expandOn)a=n.expandOn,n.expandingProperty=n.expandOn;else if(n.treeData.length){for(var e=n.treeData[0],r=Object.keys(e),i=0,l=r.length;i<l;i++)if("string"==typeof e[r[i]]){a=r[i];break}a||(a=r[0]),n.expandingProperty=a}};if(g(),t.colDefs)n.colDefinitions=n.colDefs;else if(n.treeData.length){var _=[],b=n.treeData[0],v=["children","level","expanded",a];for(var x in b)-1===v.indexOf(x)&&_.push({field:x});n.colDefinitions=_}o=function(e){var r,t,a,i,l,c;for(r=function(n,t){var a,i,l,c,o;if(e(n,t),null!=n.children){for(o=[],i=0,l=(c=n.children).length;i<l;i++)a=c[i],o.push(r(a,t+1));return o}},c=[],a=0,i=(l=n.treeData).length;a<i;a++)t=l[a],c.push(r(t,1));return c},f=null,p=function(r){if(!r)return null!=f&&(f.selected=!1),void(f=null);if(r!==f){if(null!=f&&(f.selected=!1),r.selected=!0,f=r,i(r),null!=r.onSelect)return e(function(){return r.onSelect(r)});if(null!=n.onSelect)return e(function(){return n.onSelect({branch:r})})}},n.on_user_click=function(e){n.onClick&&n.onClick({branch:e})},n.user_clicks_branch=function(e){if(e!==f)return p(e)},n.addNewNodeOnTree=function(e){var r=0;angular.forEach(n.tree_rows,function(e,n){e.branch&&parseInt(e.branch.DemographicId)>r&&(r=e.branch.DemographicId)});var t={};t.level=e.level,t.DemographicId=parseInt(r)+1,t.category_name="New Category",t.groupname="New Group",t.Editable=!1,t.expanded=!1,t.first=!1,t.parent_uid=e.uid,t.children=[],e.children.push(t)},n.createNewParentTreeNode=function(){var e=new Object;e.DemographicId=111,e.ParentId=null,e.children=[],e.level=1,e.category_name="New Category",e.groupname="New Group",n.treeData.push(e)},n.checkIamvisiblenode=function(e){var r=!0;return angular.isDefined(e.uid)&&angular.isDefined(n.$parent.clientdata.disabled_uid)&&(n.$parent.clientdata.disabled_uid.indexOf(e.uid)>=0||n.$parent.clientdata.disabled_uid.indexOf(e.parent_uid)>=0)&&(r=!1),r},n.removeCurrentBrand=function(e,r){angular.isDefined(r.level)&&1==r.level&&angular.isDefined(r.uid)&&r.uid.length&&n.$parent.clientdata.disabled_uid.push(r.uid),angular.isDefined(r.level)&&2==r.level&&angular.isDefined(r.uid)&&r.uid.length&&n.$parent.clientdata.disabled_uid.push(r.uid),angular.isDefined(r.level)&&3==r.level&&angular.isDefined(r.uid)&&r.uid.length&&n.$parent.clientdata.disabled_uid.push(r.uid),angular.isDefined(r.children)&&angular.forEach(r.children,function(e,r){angular.isDefined(e.uid)&&n.$parent.clientdata.disabled_uid.push(e.uid),angular.isDefined(e.parent_uid)&&n.$parent.clientdata.disabled_uid.push(e.parent_uid)}),r.nodeDisabled=!0},n.addCopyOfNodeTree=function(e,r){var t=0;angular.forEach(r,function(e,n){e.branch&&parseInt(e.branch.DemographicId)>t&&(t=e.branch.DemographicId)});var a={};a.ParentId=e.ParentId,a.DemographicId=parseInt(t)+1,a.category_name="New Category",a.groupname="New Group",a.Editable=!1,a.expanded=!1,a.first=!1,a.children=[],null===a.ParentId?(a.level=1,n.treeData.push(a)):(a.parent_uid=e.uid,angular.forEach(r,function(n,r){n.branch.uid==e.parent_uid&&n.branch.children.push(a)}))},n.changeCurrentBranchGroupValue=function(e,r){var t="";angular.forEach(n.$parent.clientdata.billGroup,function(e,n){e.groupunique==r&&(t=e.groupname)}),e.groupname=t},n.treeSelectedRow=function(e){n.selectedIndex=e},n.getOneCopyOfGroupList=function(){return n.$parent.clientdata.billGroup},n.sortBy=function(e){"asc"===e.sortDirection?(n.treeData.sort(w(e.field,!0,e.sortingType)),e.sortDirection="desc",e.sortingIcon=t.sortedDesc):(n.treeData.sort(w(e.field,!1,e.sortingType)),e.sortDirection="asc",e.sortingIcon=t.sortedAsc),e.sorted=!0,m(e)};var w=function(e,n,r){var t="number"===r?function(n){return parseFloat(n[e])}:function(n){return null===n[e]?"":n[e].toLowerCase()},a=n?-1:1;return function(e,n){return e=t(e),n=t(n),a*((e>n)-(n>e))}},m=function(e){for(var r=n.colDefinitions.length,t=0;t<r;t++){var a=n.colDefinitions[t];a.field!=e.field&&(a.sorted=!1,a.sortDirection="none")}};return u=function(e){var n;return n=void 0,e.parent_uid&&o(function(r){if(r.uid===e.parent_uid)return n=r}),n},c=function(e,n){var r;if(null!=(r=u(e)))return n(r),c(r,n)},i=function(e){return c(e,function(e){return e.expanded=!0})},n.tree_rows=[],s=function(){g();var e,r,i,l,c,u;for(o(function(e,n){if(!e.uid){var r=new Date;return e.uid=""+Math.random()+r.getTime()}}),o(function(e){var n,r,t,a,i;if(angular.isArray(e.children)){for(i=[],r=0,t=(a=e.children).length;r<t;r++)n=a[r],i.push(n.parent_uid=e.uid);return i}}),n.tree_rows=[],o(function(e){var n,r;return e.children?e.children.length>0?(r=function(e){return"string"==typeof e?{label:e,children:[]}:e},e.children=function(){var t,a,i,l;for(l=[],t=0,a=(i=e.children).length;t<a;t++)n=i[t],l.push(r(n));return l}()):void 0:e.children=[]}),e=function(r,i,l){var c,o,u,d,s,p,f;if(null==i.expanded&&(i.expanded=!1),u=i.children&&0!==i.children.length?i.expanded?t.iconCollapse:t.iconExpand:t.iconLeaf,i.level=r,n.tree_rows.push({level:r,branch:i,label:i[a],tree_icon:u,visible:l}),n.$parent.treeGridDataStorage=n.tree_rows,n.$parent.treeGridDatas=n.tree_rows,null!=i.children){for(f=[],d=0,s=(p=i.children).length;d<s;d++)c=p[d],o=l&&i.expanded,f.push(e(r+1,c,o));return f}},u=[],i=0,l=(c=n.treeData).length;i<l;i++)r=c[i],u.push(e(1,r,!0));return u},n.$watch("treeData",s,!0),null!=t.initialSelection&&o(function(n){if(n.label===t.initialSelection)return e(function(){return p(n)})}),d=n.treeData.length,o(function(e,n){return e.level=n,e.expanded=e.level<l}),null!=n.treeControl&&angular.isObject(n.treeControl)?(h=n.treeControl,h.expand_all=function(){return o(function(e,n){return e.expanded=!0})},h.collapse_all=function(){return o(function(e,n){return e.expanded=!1})},h.get_first_branch=function(){if((d=n.treeData.length)>0)return n.treeData[0]},h.select_first_branch=function(){var e;return e=h.get_first_branch(),h.select_branch(e)},h.get_selected_branch=function(){return f},h.get_parent_branch=function(e){return u(e)},h.select_branch=function(e){return p(e),e},h.get_children=function(e){return e.children},h.select_parent_branch=function(e){var n;if(null==e&&(e=h.get_selected_branch()),null!=e&&null!=(n=h.get_parent_branch(e)))return h.select_branch(n),n},h.add_branch=function(e,r){return null!=e?(e.children.push(r),e.expanded=!0):n.treeData.push(r),r},h.add_root_branch=function(e){return h.add_branch(null,e),e},h.expand_branch=function(e){if(null==e&&(e=h.get_selected_branch()),null!=e)return e.expanded=!0,e},h.collapse_branch=function(e){if(null==e&&(e=f),null!=e)return e.expanded=!1,e},h.get_siblings=function(e){var r;if(null==e&&(e=f),null!=e)return r=h.get_parent_branch(e),r?r.children:n.treeData},h.get_next_sibling=function(e){var n,r;if(null==e&&(e=f),null!=e&&(r=h.get_siblings(e),d=r.length,(n=r.indexOf(e))<d))return r[n+1]},h.get_prev_sibling=function(e){var n,r;if(null==e&&(e=f),r=h.get_siblings(e),d=r.length,(n=r.indexOf(e))>0)return r[n-1]},h.select_next_sibling=function(e){var n;if(null==e&&(e=f),null!=e&&null!=(n=h.get_next_sibling(e)))return h.select_branch(n)},h.select_prev_sibling=function(e){var n;if(null==e&&(e=f),null!=e&&null!=(n=h.get_prev_sibling(e)))return h.select_branch(n)},h.get_first_child=function(e){var n;if(null==e&&(e=f),null!=e&&(null!=(n=e.children)?n.length:void 0)>0)return e.children[0]},h.get_closest_ancestor_next_sibling=function(e){var n,r;return n=h.get_next_sibling(e),null!=n?n:(r=h.get_parent_branch(e),h.get_closest_ancestor_next_sibling(r))},h.get_next_branch=function(e){var n;if(null==e&&(e=f),null!=e)return n=h.get_first_child(e),null!=n?n:n=h.get_closest_ancestor_next_sibling(e)},h.select_next_branch=function(e){var n;if(null==e&&(e=f),null!=e&&null!=(n=h.get_next_branch(e)))return h.select_branch(n),n},h.last_descendant=function(e){var n;return d=e.children.length,0===d?e:(n=e.children[d-1],h.last_descendant(n))},h.get_prev_branch=function(e){var n;if(null==e&&(e=f),null!=e)return n=h.get_prev_sibling(e),null!=n?h.last_descendant(n):h.get_parent_branch(e)},h.select_prev_branch=function(e){var n;if(null==e&&(e=f),null!=e&&null!=(n=h.get_prev_branch(e)))return h.select_branch(n),n}):void 0}alert("No data was defined for the tree, please define treeData!")}}}]).provider("treegridTemplate",function(){var e="template/treeGrid/treeGrid.html";this.setPath=function(n){e=n},this.$get=function(){return{getPath:function(){return e}}}}).filter("searchFor",function(){function e(e,r,t,a){var i=!1,l=!1;t.filterable&&(l=!0,n(e,r,t)&&(i=!0));for(var c=a.length,o=0;o<c;o++){var u=a[o];u.filterable&&(l=!0,n(e,r,u)&&(i=!0))}return!l||i}function n(e,n,r){if("number"===r.sortingType){if(null!=e.branch[r.field]&&parseFloat(e.branch[r.field])===parseFloat(n))return!0}else if(null!=e.branch[r.field]&&-1!==e.branch[r.field].toLowerCase().indexOf(n.toLowerCase()))return!0}return function(n,r,t,a){var i=[];if(!r||r.length<3)for(o=0;o<n.length;o++)(u=n[o]).visible&&i.push(u);else for(var l=[],c=0,o=0;o<n.length;o++){for(var u=n[o];c>=u.level;)throwAway=l.pop(),c--;if(l.push(u),c=u.level,e(u,r,t,a)){for(var d=0;d<l.length;d++)ancestor=l[d],ancestor.visible&&i.push(ancestor);l=[]}}return i}})}).call(window);